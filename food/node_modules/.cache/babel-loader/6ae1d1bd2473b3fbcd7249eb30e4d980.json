{"ast":null,"code":"import _objectSpread from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{Table,Button,Modal,ModalHeader,ModalBody,ModalFooter,Input}from'reactstrap';import Axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ListFoods=/*#__PURE__*/function(_Component){_inherits(ListFoods,_Component);var _super=_createSuper(ListFoods);function ListFoods(props){var _this;_classCallCheck(this,ListFoods);_this=_super.call(this,props);_this.toggle=function(){_this.setState({modal:!_this.state.modal});};_this.handleFileSelect=function(e){_this.setState({selectedFile:e.target.files[0],imgpreview:URL.createObjectURL(e.target.files[0])});};_this.uploadFile=function(e){e.preventDefault();var data=new FormData();data.append('imageFile',_this.state.selectedFile);Axios.post('http://localhost:90/upload',data,_this.state.config).then(function(response){_this.setState({foodname:_this.state.foodname,price:_this.state.price,foodimage:response.data.filename});}).catch(function(err){return console.log(err.response);});};_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};_this.handleEdit=function(foodId){_this.setState({modal:!_this.state.modal});Axios.get(\"http://localhost:90/foods/\".concat(foodId),_this.state.config).then(function(response){var data=response.data;_this.setState({food:data,resSelect:data.restaurant._id,catSelect:data.category._id,imgpreview:\"http://localhost:90/pictures/\".concat(data.foodimage)});console.log(\"data fecth\"+data);}).catch(function(error){return console.log(error.response);});};_this.handleupdate=function(e){_this.setState({food:_objectSpread(_objectSpread({},_this.state.food),{},_defineProperty({},e.target.name,e.target.value))});};_this.updateFood=function(foodId){var data=new FormData();data.append('imageFile',_this.state.selectedFile);Axios.post('http://localhost:90/upload',data,_this.state.config).then(function(response){_this.setState({foodimage:response.data.filename});Axios.put(\"http://localhost:90/foods/\".concat(foodId),{foodname:_this.state.food.foodname,price:_this.state.food.price,foodimage:_this.state.foodimage,restaurant:_this.state.resSelect,category:_this.state.catSelect},_this.state.config).then(function(response){alert(\"Food updated successfully\");console.log(response.data);window.location.reload();}).catch(function(err){return console.log(err.response);});}).catch(function(err){return console.log(err.response);});};_this.state={_id:'',foodname:'',foodimage:'',price:'',imgpreview:null,popular:[],food:[],categorys:[],resturant:[],resSelect:'',catSelect:'',modal:false,isupdated:false,config:{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}},selectedFile:null};_this.toggle=_this.toggle.bind(_assertThisInitialized(_this));return _this;}_createClass(ListFoods,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;Axios.get('http://localhost:90/foods',this.config).then(function(response){var data=response.data;_this2.setState({popular:data});_this2.setState({food:data});console.log(_this2.state.popular);}).catch(function(error){return console.log(error.response);});Axios.get('http://localhost:90/resturants',this.state.config).then(function(response){var data=response.data;_this2.setState({resturant:data,resSelect:data[0]._id});}).catch(function(error){return console.log(error.response);});Axios.get('http://localhost:90/foodCat',this.state.config).then(function(response){var data=response.data;_this2.setState({categorys:data,imgpreview:data.catImg,catSelect:data[0]._id});}).catch(function(err){return console.log(err.response);});}},{key:\"deletefood\",value:function deletefood(foodId){Axios.delete(\"http://localhost:90/foods/\".concat(foodId),this.state.config).then(function(response){console.log(response);window.location.reload();}).catch(function(error){return console.log(error.response);});}},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/_jsxs(Table,{hover:true,children:[/*#__PURE__*/_jsxs(\"thead\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Foods\"}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Restaurant Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Food Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Food price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Food image\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Edit\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delete\"})]})]}),/*#__PURE__*/_jsxs(\"tbody\",{children:[this.state.popular.map(function(pop){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:pop.restaurant.resturant_name}),/*#__PURE__*/_jsx(\"td\",{children:pop.category.category}),/*#__PURE__*/_jsx(\"td\",{children:pop.foodname}),/*#__PURE__*/_jsx(\"td\",{children:pop.price}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"img\",{alt:\"foodPic\",src:\"http://localhost:90/pictures/\".concat(pop.foodimage),style:{height:\"50px\",width:\"50px\"}})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"a\",{className:\"btn btn-primary\",onClick:function onClick(){return _this3.handleEdit(pop._id);},children:\"Update\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"a\",{onClick:function onClick(){return _this3.deletefood(pop._id);},className:\"btn btn-danger\",href:\"\",children:\"Delete\"})})]},pop._id);}),/*#__PURE__*/_jsxs(Modal,{isOpen:this.state.modal,children:[/*#__PURE__*/_jsx(ModalHeader,{toggle:this.toggle,children:/*#__PURE__*/_jsx(\"legend\",{children:/*#__PURE__*/_jsx(\"h3\",{children:\"Update Food\"})})}),/*#__PURE__*/_jsx(ModalBody,{children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"foodname\",children:\" Food Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"foodname\",className:\"form-control\",value:this.state.food.foodname,onChange:this.handleupdate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"price\",children:\"Food price\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"price\",className:\"form-control\",value:this.state.food.price,onChange:this.handleupdate})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"resOption\",children:/*#__PURE__*/_jsx(\"legend\",{style:{fontSize:16},children:\"Choose Restaurant: \"})}),' ',/*#__PURE__*/_jsx(\"select\",{onChange:this.handleChange,value:this.state.resSelect,name:\"resSelect\",id:\"resOption\",style:{width:200,textAlign:'center'},children:this.state.resturant.map(function(option){return/*#__PURE__*/_jsx(\"option\",{value:option._id,children:option.resturant_name},option._id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{for:\"resOption\",children:/*#__PURE__*/_jsx(\"legend\",{style:{fontSize:16},children:\"Choose Food Category: \"})}),' ',/*#__PURE__*/_jsx(\"select\",{onChange:this.handleChange,value:this.state.catSelect,name:\"catSelect\",id:\"catOption\",style:{width:200,textAlign:'center'},children:this.state.categorys.map(function(option){return/*#__PURE__*/_jsx(\"option\",{value:option._id,children:option.category},option._id);})})]}),/*#__PURE__*/_jsx(\"img\",{className:\"img-thumbnail\",width:\"200\",src:this.state.imgpreview,alt:\"foodimg\"}),/*#__PURE__*/_jsx(Input,{type:\"file\",name:\"foodimage\",id:\"foodimg\",onChange:this.handleFileSelect,value:this.state.image}),/*#__PURE__*/_jsx(Button,{className:\"btn btn-primary btn-block\",onClick:function onClick(){return _this3.updateFood(_this3.state.food._id);},children:\"Update\"})]})}),/*#__PURE__*/_jsx(ModalFooter,{})]})]})]});}}]);return ListFoods;}(Component);export{ListFoods as default};","map":{"version":3,"sources":["C:/Users/Dell/Downloads/Agile/food/src/Container/ListFoods.js"],"names":["React","Component","Table","Button","Modal","ModalHeader","ModalBody","ModalFooter","Input","Axios","ListFoods","props","toggle","setState","modal","state","handleFileSelect","e","selectedFile","target","files","imgpreview","URL","createObjectURL","uploadFile","preventDefault","data","FormData","append","post","config","then","response","foodname","price","foodimage","filename","catch","err","console","log","handleChange","name","value","handleEdit","foodId","get","food","resSelect","restaurant","_id","catSelect","category","error","handleupdate","updateFood","put","alert","window","location","reload","popular","categorys","resturant","isupdated","headers","localStorage","getItem","bind","catImg","delete","map","pop","resturant_name","height","width","deletefood","fontSize","textAlign","option","image"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Table, Button, Modal, ModalHeader, ModalBody, ModalFooter,Input } from 'reactstrap';\r\nimport Axios from 'axios'\r\n\r\n\r\nexport default class ListFoods extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n          _id: '',\r\n          foodname: '',\r\n          foodimage: '',\r\n          price:'',\r\n          imgpreview:null,\r\n          popular: [],\r\n          food: [],\r\n          categorys:[],\r\n          resturant:[],\r\n          resSelect:'',\r\n          catSelect:'',\r\n          modal : false,\r\n          isupdated: false,\r\n          config: {\r\n            headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }\r\n          },\r\n          selectedFile: null,\r\n        }\r\n        this.toggle = this.toggle.bind(this);\r\n    } \r\n             \r\n    componentDidMount() {\r\n      Axios.get('http://localhost:90/foods',this.config)\r\n        .then((response)=>{\r\n          const data = response.data;\r\n          this.setState({popular:  data});\r\n          this.setState({food: data});\r\n          console.log(this.state.popular);\r\n        }).catch(error => console.log(error.response));\r\n\r\n      Axios.get('http://localhost:90/resturants',this.state.config)\r\n      .then((response)=>{\r\n        const data = response.data;\r\n        this.setState({\r\n            resturant: data,\r\n            resSelect:data[0]._id\r\n          });        \r\n      }).catch(error => console.log(error.response));\r\n\r\n      Axios.get('http://localhost:90/foodCat', this.state.config)\r\n        .then((response)=>{\r\n            const data = response.data;\r\n            this.setState({\r\n                categorys:data,\r\n                imgpreview:data.catImg,\r\n                catSelect:data[0]._id\r\n            });\r\n        }).catch(err=>console.log(err.response));\r\n    }\r\n\r\n    toggle=()=>{ \r\n      this.setState({\r\n        modal: !this.state.modal\r\n    })}\r\n        \r\n    handleFileSelect = (e) => {\r\n      this.setState({\r\n        selectedFile: e.target.files[0],\r\n        imgpreview: URL.createObjectURL(e.target.files[0])\r\n      })\r\n    }\r\n     \r\n    uploadFile = (e) => {\r\n      e.preventDefault();\r\n      const data = new FormData()\r\n      data.append('imageFile', this.state.selectedFile)\r\n      Axios.post('http://localhost:90/upload', data, this.state.config)\r\n        .then((response) => {\r\n          this.setState({\r\n            foodname: this.state.foodname,\r\n            price:this.state.price,\r\n            foodimage: response.data.filename\r\n          })\r\n        }).catch((err) => console.log(err.response))\r\n    }\r\n     \r\n       \r\n    handleChange = (e)  =>{\r\n      this.setState({\r\n        [e.target.name]: e.target.value \r\n      })\r\n    }\r\n\r\n    deletefood(foodId){\r\n      Axios.delete(`http://localhost:90/foods/${foodId}`, this.state.config)\r\n      .then((response) => {\r\n        console.log(response);\r\n        window.location.reload()   \r\n      })\r\n      .catch(error => console.log(error.response));\r\n    }\r\n\r\n    handleEdit = (foodId) => {\r\n      this.setState({\r\n        modal: !this.state.modal\r\n      });\r\n      Axios.get(`http://localhost:90/foods/${foodId}`,this.state.config)\r\n      .then((response)=>{\r\n        const data = response.data;\r\n          this.setState({\r\n            food: data,\r\n            resSelect:data.restaurant._id,\r\n            catSelect:data.category._id,\r\n            imgpreview:`http://localhost:90/pictures/${data.foodimage}`\r\n          });    \r\n        console.log(\"data fecth\"+data);\r\n        })\r\n      .catch(error => console.log(error.response));\r\n    }\r\n\r\n    handleupdate = (e) =>{\r\n      this.setState({\r\n        food: { ...this.state.food, [e.target.name]: e.target.value }\r\n      })\r\n    }\r\n     \r\n    updateFood = (foodId) => {\r\n      const data = new FormData()\r\n      data.append('imageFile', this.state.selectedFile)\r\n      Axios.post('http://localhost:90/upload', data, this.state.config)\r\n        .then((response) => {\r\n          this.setState({\r\n            foodimage: response.data.filename\r\n          })\r\n          Axios.put(`http://localhost:90/foods/${foodId}`, \r\n            { \r\n              foodname: this.state.food.foodname, \r\n              price: this.state.food.price,\r\n              foodimage: this.state.foodimage, \r\n              restaurant: this.state.resSelect,\r\n              category: this.state.catSelect\r\n            }, this.state.config)\r\n          .then((response) => {\r\n            alert(\"Food updated successfully\")\r\n            console.log(response.data)\r\n            window.location.reload();\r\n          })\r\n          .catch((err)=>console.log(err.response))\r\n        })\r\n        .catch((err) => console.log(err.response))\r\n    }\r\n    \r\n    render() \r\n    {\r\n        return (\r\n          \r\n            <Table hover>\r\n            <thead>\r\n            <h1>Foods</h1>\r\n              <tr>\r\n                <th>Restaurant Name</th>\r\n                <th>Category</th>\r\n                <th>Food Name</th>\r\n                <th>Food price</th>\r\n                <th>Food image</th>\r\n                <th>Edit</th>\r\n                <th>Delete</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {\r\n                this.state.popular.map(pop => \r\n                <tr key={pop._id}>\r\n                  <td>{pop.restaurant.resturant_name}</td>\r\n                  <td>{pop.category.category}</td>\r\n                  <td>{pop.foodname}</td>\r\n                  <td>{pop.price}</td>\r\n                  <td>\r\n                    <img alt=\"foodPic\" src={`http://localhost:90/pictures/${pop.foodimage}`} style={{height: \"50px\",width:\"50px\"}}/>\r\n                  </td>\r\n                  <td>\r\n                    <a className=\"btn btn-primary\" onClick={() => this.handleEdit(pop._id)}>Update</a>\r\n                  </td>\r\n                  <td>\r\n                    <a onClick={() => this.deletefood(pop._id)} className=\"btn btn-danger\" href=\"\">Delete</a>\r\n                  </td>\r\n                </tr>\r\n                )\r\n              }\r\n    \r\n              <Modal isOpen={this.state.modal}>\r\n                <ModalHeader toggle={this.toggle}><legend><h3>Update Food</h3></legend></ModalHeader>\r\n                <ModalBody>\r\n                  <form>\r\n                    <div className=\"form-group\">\r\n                      <label for='foodname'> Food Name</label>\r\n                      <input type=\"text\" name=\"foodname\" className=\"form-control\" \r\n                        value ={this.state.food.foodname} onChange={this.handleupdate}/>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label for='price'>Food price</label>\r\n                      <input type=\"text\" name=\"price\" className=\"form-control\"\r\n                        value={this.state.food.price} onChange={this.handleupdate}  />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label for='resOption'>\r\n                            <legend style={{fontSize:16}}>Choose Restaurant: </legend>\r\n                        </label>\r\n                        {' '}\r\n                        <select onChange={this.handleChange} value={this.state.resSelect} name='resSelect' id='resOption' style={{width:200, textAlign:'center'}}>\r\n                            {\r\n                              this.state.resturant.map(option=>\r\n                                  <option key={option._id} value={option._id}>{option.resturant_name}</option>\r\n                              )\r\n                            }\r\n                        </select>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label for='resOption'>\r\n                            <legend style={{fontSize:16}}>Choose Food Category: </legend>\r\n                        </label>\r\n                        {' '}\r\n                        <select onChange={this.handleChange} value={this.state.catSelect} name='catSelect' id='catOption' style={{width:200, textAlign:'center'}}>\r\n                          {\r\n                            this.state.categorys.map(option=>\r\n                                <option key={option._id} value={option._id}>{option.category}</option>\r\n                            )\r\n                          }\r\n                        </select>\r\n                    </div>\r\n                    <img className='img-thumbnail' width='200' \r\n                      src={this.state.imgpreview} alt=\"foodimg\" />\r\n                    <Input type='file' name='foodimage' id='foodimg'\r\n                      onChange={this.handleFileSelect} value={this.state.image}/> \r\n                    <Button className=\"btn btn-primary btn-block\" \r\n                      onClick={() => this.updateFood(this.state.food._id)}>Update</Button>\r\n                  </form>     \r\n                </ModalBody>\r\n                <ModalFooter></ModalFooter>\r\n              </Modal>\r\n            </tbody>\r\n          </Table>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}