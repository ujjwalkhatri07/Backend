{"ast":null,"code":"import _defineProperty from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Dell/Downloads/Agile/food/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Axios from'axios';import{confirmAlert}from'react-confirm-alert';import'react-confirm-alert/src/react-confirm-alert.css';import moment from'moment';import{Table,Modal,ModalHeader,ModalBody,ModalFooter,Label,Input,FormGroup}from'reactstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Cart=/*#__PURE__*/function(_Component){_inherits(Cart,_Component);var _super=_createSuper(Cart);function Cart(props){var _this;_classCallCheck(this,Cart);_this=_super.call(this,props);_this.removeCardList=function(CartId){Axios.delete(\"http://localhost:90/cart/\".concat(CartId),_this.state.config).then(function(response){var filteredCartList=_this.state.cart.filter(function(cart){return cart._id!==CartId;});_this.setState({visible1:true,cart:filteredCartList});}).catch(function(err){return console.log(err.response);});};_this.handleChange=function(e){_this.setState({viewfood:_objectSpread(_objectSpread({},_this.state.viewfood),{},_defineProperty({},e.target.name,e.target.validity.valid?e.target.value:''))});};_this.handleEdit=function(foodId){_this.setState({modal:!_this.state.modal});Axios.get(\"http://localhost:90/cart/\".concat(foodId),_this.state.config).then(function(response){var data=response.data;_this.setState({viewfood:data});console.log(_this.state.viewfood);}).catch(function(error){return console.log(error.response);});};_this.handleUpdate=function(cartId){Axios.put(\"http://localhost:90/cart/\".concat(cartId),{quanity:_this.state.viewfood.quanity,totalprice:_this.state.viewfood.food.price*_this.state.viewfood.quanity,notes:_this.state.viewfood.notes},_this.state.config).then(function(response){console.log(response);_this.setState({modal:!_this.state.modal});}).catch(function(err){return console.log(err.response);});alert(\"updated successfully\");window.location.reload();};_this.handleOrder=function(){_this.state.cart.forEach(function(item){Axios.post(\"http://localhost:90/order/\",{food:item.food._id,notes:item.notes,dateTime:moment().utcOffset('+05:30').format('YYYY-MM-DD hh:mm a'),quanity:item.quanity},_this.state.config).then(function(response){Axios.delete(\"http://localhost:90/cart/\".concat(item._id),_this.state.config).then(function(response){console.log(\"Deleted Successfully\");window.location.reload();}).catch(function(err){return console.log(err.response);});console.log(response);alert(\"Ordered successfully\");}).catch(function(err){return console.log(err.response);});});};_this.submit=function(){confirmAlert({title:'Confirm to order',message:'Are you sure to order this items.',buttons:[{label:'Yes',onClick:function onClick(){return _this.handleOrder();}},{label:'No'}]});};_this.state={user:[],cart:[],food:[],notes:'',viewfood:[],modal:false,foodname:'',totalprice:'',totAmt:0,updatedprice:0,updatedquanity:'',quanity:1,show:true,max:5,min:0,config:{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}},CartId:''};_this.toggle=_this.toggle.bind(_assertThisInitialized(_this));return _this;}_createClass(Cart,[{key:\"toggle\",value:function toggle(){this.setState({modal:!this.state.modal});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;Axios.get('http://localhost:90/cart',this.state.config).then(function(response){console.log(response.data);_this2.setState({cart:response.data});}).catch(function(err){return console.log(err.response);});}},{key:\"render\",value:function render(){var _this3=this;//Try for loop:\n// for (let i = 0; i < this.state.cart.length; i++) {\n//   this.state.totAmt += this.state.cart[i].totalprice;\n// }\n//OR this method\n// Calculation of the total amount of cart\nthis.state.totAmt=this.state.cart.reduce(function(prevValue,currentValue){return prevValue+currentValue.totalprice;},0);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{class:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"viewCartDiv\",children:[/*#__PURE__*/_jsxs(Table,{hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Product\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Note\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Update\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Delete\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:this.state.cart.map(function(cart){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:cart.food.foodname}),/*#__PURE__*/_jsx(\"td\",{children:cart.notes}),/*#__PURE__*/_jsx(\"td\",{children:cart.quanity}),/*#__PURE__*/_jsx(\"td\",{children:cart.food.price*cart.quanity}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-primary\",onClick:function onClick(){return _this3.handleEdit(cart._id);},children:\"Update\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-danger\",onClick:function onClick(){return _this3.removeCardList(cart._id);},children:\"Remove\"})})]},cart._id);})}),/*#__PURE__*/_jsxs(\"tfoot\",{children:[/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",align:\"right\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Total Amount: Rs \",this.state.totAmt]})})}),/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",align:\"right\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",class:\"btn btn-lg btn-success\",onClick:this.submit,children:\"Order\"})})})]})]}),/*#__PURE__*/_jsxs(Modal,{isOpen:this.state.modal,children:[/*#__PURE__*/_jsxs(ModalHeader,{toggle:this.toggle,children:[this.state.viewfood.food?this.state.viewfood.food.foodname:\"\",/*#__PURE__*/_jsx(\"br\",{}),\"Rs.\",this.state.viewfood.totalprice]}),/*#__PURE__*/_jsxs(ModalBody,{children:[/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"notes\",children:\"Add notes\"}),/*#__PURE__*/_jsx(Input,{id:\"notes\",type:\"textarea\",name:\"notes\",value:this.state.viewfood.notes,onChange:this.handleChange})]}),/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{children:\"Quantity\"}),/*#__PURE__*/_jsx(Input,{type:\"number\",pattern:\"[0-9]*\",name:\"quanity\",value:this.state.viewfood.quanity,onChange:this.handleChange,min:\"1\",max:\"100\"})]})]}),/*#__PURE__*/_jsx(ModalFooter,{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-lg btn-success\",id:\"btnbag\",onClick:function onClick(){return _this3.handleUpdate(_this3.state.viewfood._id);},children:\"Update\"})})]})]})})});}}]);return Cart;}(Component);export{Cart as default};","map":{"version":3,"sources":["C:/Users/Dell/Downloads/Agile/food/src/Container/User_dahboard/Viewcart.js"],"names":["React","Component","Axios","confirmAlert","moment","Table","Modal","ModalHeader","ModalBody","ModalFooter","Label","Input","FormGroup","Cart","props","removeCardList","CartId","delete","state","config","then","response","filteredCartList","cart","filter","_id","setState","visible1","catch","err","console","log","handleChange","e","viewfood","target","name","validity","valid","value","handleEdit","foodId","modal","get","data","error","handleUpdate","cartId","put","quanity","totalprice","food","price","notes","alert","window","location","reload","handleOrder","forEach","item","post","dateTime","utcOffset","format","submit","title","message","buttons","label","onClick","user","foodname","totAmt","updatedprice","updatedquanity","show","max","min","headers","localStorage","getItem","toggle","bind","reduce","prevValue","currentValue","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport Axios from 'axios'\r\nimport { confirmAlert } from 'react-confirm-alert';\r\nimport 'react-confirm-alert/src/react-confirm-alert.css';\r\nimport moment from 'moment';\r\nimport { Table, Modal, ModalHeader, ModalBody, ModalFooter, Label, Input, FormGroup} from 'reactstrap';\r\n\r\n\r\nexport default class Cart extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      user: [],\r\n      cart: [],\r\n      food: [],\r\n      notes:'',\r\n      viewfood: [],\r\n      modal: false,\r\n      foodname: '',\r\n      totalprice: '',\r\n      totAmt:0,\r\n      updatedprice: 0,\r\n      updatedquanity: '',\r\n      quanity:1,\r\n      show: true,\r\n      max: 5,\r\n      min: 0,\r\n      config: {\r\n        headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }\r\n      },\r\n      CartId: ''\r\n    }\r\n    this.toggle = this.toggle.bind(this);\r\n  }\r\n\r\n  toggle() {\r\n    this.setState({\r\n      modal: !this.state.modal\r\n    })\r\n  }\r\n\r\n  componentDidMount() {\r\n    Axios.get('http://localhost:90/cart', this.state.config)\r\n      .then((response) => {\r\n        console.log(response.data)\r\n        this.setState({\r\n          cart: response.data,\r\n        })\r\n      })\r\n      .catch((err) => console.log(err.response));\r\n  }\r\n\r\n  removeCardList = (CartId) => {\r\n    Axios.delete(`http://localhost:90/cart/${CartId}`, this.state.config)\r\n      .then((response) => {\r\n        const filteredCartList = this.state.cart.filter((cart) => {\r\n          return cart._id !== CartId\r\n        })\r\n        this.setState({\r\n          visible1: true,\r\n          cart: filteredCartList\r\n        })\r\n      }).catch((err) => console.log(err.response));\r\n  }\r\n\r\n  handleChange = (e) => {\r\n    this.setState({\r\n      viewfood:{...this.state.viewfood, [e.target.name]: (e.target.validity.valid) ? e.target.value:''}\r\n    })\r\n  }\r\n\r\n  handleEdit = (foodId) => {\r\n    this.setState({\r\n      modal: !this.state.modal\r\n    })\r\n    Axios.get(`http://localhost:90/cart/${foodId}`, this.state.config)\r\n      .then((response) => {\r\n        const data = response.data;\r\n        this.setState({\r\n          viewfood: data\r\n        });\r\n        console.log(this.state.viewfood);\r\n      }).catch(error => console.log(error.response));\r\n  }\r\n\r\n  handleUpdate = (cartId) => {\r\n    Axios.put(`http://localhost:90/cart/${cartId}`,{\r\n      quanity: this.state.viewfood.quanity,\r\n      totalprice: (this.state.viewfood.food.price * this.state.viewfood.quanity),\r\n      notes: this.state.viewfood.notes,\r\n    }, this.state.config)\r\n      .then((response) => {\r\n        console.log(response);\r\n        this.setState({\r\n          modal: !this.state.modal\r\n        })\r\n      }).catch((err) => console.log(err.response));\r\n      alert(\"updated successfully\")\r\n      window.location.reload();\r\n  }\r\n\r\n  handleOrder = () => {\r\n    this.state.cart.forEach(item => {\r\n      Axios.post(`http://localhost:90/order/`,\r\n      {\r\n        food: item.food._id,\r\n        notes: item.notes,\r\n        dateTime: moment().utcOffset('+05:30').format('YYYY-MM-DD hh:mm a'),\r\n        quanity: item.quanity\r\n      }, this.state.config)\r\n      .then((response) => {\r\n        Axios.delete(`http://localhost:90/cart/${item._id}`, this.state.config)\r\n          .then((response)=>{\r\n            console.log(\"Deleted Successfully\")\r\n            window.location.reload();\r\n          }).catch((err)=>console.log(err.response));\r\n          \r\n        console.log(response);\r\n        alert(\"Ordered successfully\")\r\n      }).catch((err) => console.log(err.response));\r\n    });\r\n  }\r\n\r\n  submit = () => {\r\n    confirmAlert({\r\n      title: 'Confirm to order',\r\n      message: 'Are you sure to order this items.',\r\n      buttons: [\r\n        {\r\n          label: 'Yes',\r\n          onClick: () => this.handleOrder()\r\n        },\r\n        {\r\n          label: 'No',\r\n        }\r\n      ]\r\n    });\r\n  };\r\n\r\n  render() {\r\n    //Try for loop:\r\n    // for (let i = 0; i < this.state.cart.length; i++) {\r\n    //   this.state.totAmt += this.state.cart[i].totalprice;\r\n    // }\r\n\r\n    //OR this method\r\n    // Calculation of the total amount of cart\r\n    this.state.totAmt = this.state.cart.reduce(\r\n      (prevValue, currentValue) => prevValue + currentValue.totalprice,\r\n      0\r\n    );\r\n\r\n    return (\r\n      <>\r\n    \r\n      <div class=\"container-fluid\">\r\n      <div id=\"viewCartDiv\">\r\n        <Table hover>\r\n          <thead>\r\n            <tr>\r\n              <th>Product</th>\r\n              <th>Note</th>\r\n              <th>Quantity</th>\r\n              <th>Price</th>\r\n              <th>Update</th>\r\n              <th>Delete</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {\r\n              this.state.cart.map(cart => {\r\n                return (\r\n                  <tr key={cart._id}>\r\n                  <td>{cart.food.foodname}</td>\r\n                  <td>{cart.notes}</td>\r\n                  <td>{cart.quanity}</td>\r\n                  <td>{cart.food.price * cart.quanity}</td>   \r\n                  <td>\r\n                    <button type=\"button\" class=\"btn btn-primary\"\r\n                      onClick={() => this.handleEdit(cart._id)} >Update</button>\r\n                  </td>\r\n                  <td><button type=\"button\" class=\"btn btn-danger\" onClick={() => this.removeCardList(cart._id)}>Remove</button></td>\r\n                </tr>)\r\n              })\r\n            }\r\n          </tbody>\r\n          <tfoot>\r\n            <tr>\r\n              <td colSpan=\"6\" align=\"right\">\r\n                <label>Total Amount: Rs {this.state.totAmt}</label>\r\n              </td>\r\n            </tr>\r\n            <tr>\r\n              <td colSpan=\"6\" align=\"right\">\r\n              <button type=\"button\" class=\"btn btn-lg btn-success\"\r\n              onClick={this.submit} >Order</button>\r\n              </td>\r\n            </tr>\r\n          </tfoot>\r\n        </Table>\r\n\r\n        <Modal isOpen={this.state.modal}>\r\n          <ModalHeader toggle={this.toggle}>{this.state.viewfood.food?this.state.viewfood.food.foodname:\"\"}<br/>\r\n              Rs.{this.state.viewfood.totalprice}\r\n          </ModalHeader>\r\n          <ModalBody>\r\n            <FormGroup>\r\n              <Label htmlFor=\"notes\">Add notes</Label>\r\n              <Input id=\"notes\" \r\n                type=\"textarea\"\r\n                name=\"notes\" \r\n                value={this.state.viewfood.notes} \r\n                onChange={this.handleChange}\r\n              />\r\n            </FormGroup>\r\n            <FormGroup>\r\n              <Label>Quantity</Label>\r\n              <Input \r\n                type=\"number\" \r\n                pattern=\"[0-9]*\" \r\n                name=\"quanity\" \r\n                value={this.state.viewfood.quanity} \r\n                onChange={this.handleChange} \r\n                min=\"1\" \r\n                max=\"100\" \r\n              />\r\n            </FormGroup>\r\n          </ModalBody>\r\n          <ModalFooter>\r\n              <button className=\"btn btn-lg btn-success\" id=\"btnbag\" onClick={() => this.handleUpdate(this.state.viewfood._id)}>Update</button>\r\n          </ModalFooter>\r\n        </Modal>\r\n      </div>\r\n      </div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}